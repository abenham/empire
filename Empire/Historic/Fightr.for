	SUBROUTINE FIGHTR
C
C THIS SUBROUTINE HANDLES ENEMY FIGHTER MOVES
C
	INCLUDE "EMPIRE.INC/NOLIST"
	DATA OUTOFGAS/0/
C 
C IFO=7: CITY LOCATION
C IFO=6: CARRIER NUMBER
C IFO=5: TargetCity LOCATION
C IFO=4: TargetCity LOCATION, KAMIKAZE MISSION
C IFO=3: DIRECTIONAL
C IFO=2: DIRECTIONAL, KAMIKAZE MISSION
C
	MONKEY=0
	EnemyCount(2)=0
	IF (DebugLevel.EQ.2) TYPE 999,OUTOFGAS
999	FORMAT(" FIGHTER CODES",I4)
	DO 3600 Y=1,UpperIndex(10)
	DO 3500 I1=1,4
	Z6=UnitLocation(2000+Y)
	IF (Z6.EQ.0) GOTO 3600
	MONKEY=Y
	STOPF=1
	P=0
	Z7=Z6
	AB=ReferenceMap(Z6)
	DO 100 IA=1,6
	DO 100 IB=1,5
100	IF (TROOPT(IA,IB).EQ.Z6) TROOPT(IA,IB)=0
	IF ((AB.NE."f").AND.(AB.NE."X").AND.(AB.NE."c")) GOTO 3400
	IF ((AB.EQ."X").OR.(AB.EQ."c")) RANG(Y)=20
	IF (RANG(Y).NE.0) GOTO 200
	OUTOFGAS=OUTOFGAS+1
	ReferenceMap(Z6)=MasterMap(Z6)
	GOTO 3400
C 
C MOVE SELECTION
C
200	IF (UnitActionTarget(Y+IFI2-1500).EQ.Z6) GOTO 1100
	IFO=UnitAction(Y+IFI2-1500)
	ILA=UnitActionTarget(Y+IFI2-1500)
C 
C DOES A NEW CODE NEED TO BE SELECTED? 1100:YES, 2600:NO
C
	GOTO (1100,300,600,700,800,900,1000) IFO
	GOTO 1100
C 
300	IF (RND(100).LT.5) ILA=ICORR(ILA+1)	'**
	IF (RANG(Y).GT.10) GOTO 2600
	DO 400 I=1,70
	IF (CityLocation(I).EQ.0.OR.CityOwner(I).NE.2) GOTO 400
	IF (IDIST(Z6,CityLocation(I)).GT.RANG(Y)) GOTO 400
	IFO=7
	ILA=CityLocation(I)
	GOTO 2600
400	CONTINUE
C 
600	IF (RND(100).LT.10) ILA=ICORR(ILA+1)	'**
	IF (RANG(Y).LE.11) GOTO 1100
	GOTO 2600
C 
700	IF (ILA.EQ.Z6) GOTO 1100
	IF (IDIST(Z6,ILA).EQ.1) GOTO 1100
	GOTO 2600
C 
800	IF ((ILA.EQ.Z6).OR.(RANG(Y).LE.11)) GOTO 1100
	IF (IDIST(Z6,ILA).EQ.1) GOTO 1100
	GOTO 2600
C 
900	IF (Z6.EQ.UnitLocation(ILA+2800)) GOTO 1100	'IF LANDED
	IF (UnitLocation(ILA+2800).EQ.0) GOTO 1100	'IF CARRIER DOESN"T ECityLocationIST
	IF (IDIST(Z6,UnitLocation(ILA+2800)).GT.RANG(Y)) GOTO 1100	'IF OUT OF RANG
	GOTO 2600
C 
1000	IF (Z6.EQ.ILA) GOTO 1100			'IF LANDED
	IF (IDIST(Z6,ILA).GT.RANG(Y)) GOTO 1100	'IF OUT OF RANG
	GOTO 2600
C 
C NEW CODE SELECTION
C
1100	ID=0
	FUEL=RANG(Y)/2	'DO THIS SO CRAFT CAN RETURN TO REFUEL
	GOTO 1400	'NO KAMIKAZE ON FIRST TRY
1200	FUEL=RANG(Y)	'BE KAMIKAZE
C
C CURRENTLY THIS PATH IS ECityLocationECUTED TWICE.
C
C LOOK FOR ENEMY TROOP TRANSPORTS, THEN SUBMARINES
C
1400	DO 1700 ISHIPT=3,2,-1	'ENEMY TROOP TRANSPORTS, THEN SUBS
	DO 1600 I=1,5
	IF (TROOPT(ISHIPT,I).EQ.0) GOTO 1600
	IF (IDIST(Z6,TROOPT(ISHIPT,I)).GT.FUEL) GOTO 1600	'OUT OF RANG
	IFO=5
	IF (FUEL.EQ.RANG(Y)) IFO=4
	ILA=TROOPT(ISHIPT,I)
	GOTO 2600	'PROCEED TO MOVE CORRECTION
1600	CONTINUE
1700	CONTINUE
C
C MOVE TOWARD AN ENEMY CONCENTRATION WITHIN RANG IN SUPPORT OF OUR ARMIES,
C INCLUDING OUR TROOP TRANSPORTS
C
	TRY=0
	IF (RND(100).LT.25) GOTO 1950
1900	IK=RND(UpperIndex(9))+1
	DO 2000 IK=IK,IK+UpperIndex(9)-1	'FIRST SUPPORT LAND ARMIES
	K=IK
	IF (K.GT.UpperIndex(9)) K=K-UpperIndex(9)
	IF (UnitLocation(K+CArmyStart).EQ.0) GOTO 2000
	IF (UnitAction(K).EQ.2) GOTO 1920
	IF (UnitAction(K).NE.1) GOTO 2000
	IF (EMAP(UnitActionTarget(K)).NE."O") GOTO 2000
1920	IF (IDIST(UnitLocation(K+CArmyStart),UnitActionTarget(K)).GT.7) GOTO 2000 'DON"T BE TO SOON
	DIST=IDIST(Z6,UnitActionTarget(K))
	IF (DIST.LT.2) GOTO 2000	'IF WE ARE THERE ALREADY, DO SOMETHING
	IF (DIST.GT.FUEL) GOTO 2000	'IF OUT OF RANG
	IFO=5
	IF (FUEL.EQ.RANG(Y)) IFO=4	'KAMIKAZE
	ILA=UnitActionTarget(K)
	GOTO 2600			'PROCEED TO MOVE CORRECTION
2000	CONTINUE
	TRY=TRY+1
	IF (TRY.GT.1) GOTO 2075
C
C SUPPORT A TROOP TRANSPORT LANDING
C
1950	DO 2050 K=1,UpperIndex(13)		'NOW TRY TO SUPPORT ATTACKS BY TT"S
	IF (UnitLocation(K+CTransportStart).EQ.0) GOTO 2050
	IF (UnitAction(K+CTransportStart-1500).NE.9) GOTO 2050
	IF (EMAP(UnitActionTarget(K+CTransportStart-1500)).EQ."*") GOTO 2050
	IF (IDIST(UnitLocation(K+CTransportStart),UnitActionTarget(K+CTransportStart-1500)).GT.15) GOTO 2050
	DIST=IDIST(Z6,UnitActionTarget(K+CTransportStart-1500))
	IF (DIST.LT.2) GOTO 2050	'DO SOMETHING ELSE IF THERE
	IF (DIST.GT.FUEL) GOTO 2050	'IF OUT OF RANG
	IFO=5
	IF (FUEL.EQ.RANG(Y)) IFO=4	'KAMIKAZE
	ILA=UnitActionTarget(K+CTransportStart-1500)
	GOTO 2600			'PROCEED TO MOVE CORRECTION
2050	CONTINUE
	TRY=TRY+1
	IF (TRY.LE.1) GOTO 1900
2075	IF (ID.EQ.1000) GOTO 1800	'USE FIGHTER FOR ECityLocationPLORATION
C
C NOW MOVE TOWARDS A CITY OR CARRIER CLOSER TO OUR FRONT LINE ARMIES
C
2100	IK=RND(UpperIndex(9))+1
	DO 2150 IK=IK,IK+UpperIndex(9)-1	'FIRST SUPPORT LAND ARMIES
	K=IK
	IF (K.GT.UpperIndex(9)) K=K-UpperIndex(9)
	IF (UnitLocation(K+CArmyStart).EQ.0) GOTO 2150
	IF ((UnitAction(K).NE.1).AND.(UnitAction(K).NE.2)) GOTO 2150
	CALL FTRCTY(Z6,RANG(Y),UnitActionTarget(K),IFO,ILA,ID)
	IF (ID.NE.1000) GOTO 2600	'FOUND A CLOSER CITY OR CARRIER
2150	CONTINUE
C
C NOW TRY A CITY CLOSER TO AN ATTACKING TROOP TRANSPORT
C
	DO 2200 K=1,UpperIndex(13)		'NOW TRY TO SUPPORT ATTACKS BY TT"S
	IF (UnitLocation(K+CTransportStart).EQ.0) GOTO 2200
	IF (UnitAction(K+CTransportStart-1500).NE.9) GOTO 2200
	CALL FTRCTY(Z6,RANG(Y),UnitActionTarget(K+CTransportStart-1500),IFO,ILA,ID)
	IF (ID.NE.1000) GOTO 2600	'FOUND A CLOSER CITY OR CARRIER
2200	CONTINUE
C
	IF (RANG(Y).NE.FUEL) GOTO 1200	'NOW SEARCH AS KAMIKAZE
					'SINCE NO CITY CLOSER TO ENEMY
C
C FIGHTER IS NOT USEFUL IN SUPPORT OF ANYTHING, USE IT TO ECityLocationPLORE
C
1800	IF ((RND(100).LT.50).AND.(RANG(Y).GT.11)) GOTO 1850
	LOC=EXPL()
	IF (RANG(Y).LE.11) LOC=Z6
	CALL FTRCTY(Z6,RANG(Y),LOC,IFO,ILA,ID)
	IF (ID.NE.1000) GOTO 2600	'FOUND A CLOSER CITY OR CARRIER
1850	IFO=3
	ILA=RND(8)+1
	IF (RND(100).LT.5) IFO=2	'** ONE OUT OF 20 WILL BE KAMIKAZE
	IF (EnemyCount(2).LE.2) IFO=3
C
C MOVE CORRECTION
C
2600	IZOT=0
	MOOV=0
	IF (ILA.GT.100) IZOT=MOV(Z6,ILA)
	IF (ILA.LT.10) IZOT=ILA
	IF (IFO.EQ.6) IZOT=MOV(Z6,UnitLocation(2800+ILA))
	IF ((IFO.LT.4).AND.(RND(100).LT.5)) IZOT=ICORR(IZOT+1)	'**
	DO 2700 I=1,8
	AC=ReferenceMap(Z6+MoveOffset(I+1))		'**
	IF ((AC.NE."C").AND.(AC.NE."S").AND.(AC.NE."T").AND.(AC.NE."A")
	1	.AND.(AC.NE."F")) GOTO 2700
	MOOV=I
	GOTO 3100
2700	CONTINUE
C 
C LOOK FOR TERRITORY TO ECityLocationPLOR IN FRONT
C
	IF (RANG(Y).LE.10) GOTO 2900		'IF LOW ON FUEL
	IZOT2=IZOT				'STORE IZOT A MOMENT
	J=-1
	IF (RND(100).LT.50) J=1
	DO 2800 J=J,-J,-2*J			'TRY BOTH SIDES OF DIRECTION
	DIR=MoveOffset(ICORR(IZOT2+J)+1)
	Z62=Z6
	DO 2750 I=1,7				'TRY SEVERAL MOVES AWAY
	Z62=Z62+DIR
	IF (ORDER(Z62).NE.0) GOTO 2760		'IF ON THE EDGE OF THE MAP
	IF (EMAP(Z62).EQ." ") IZOT=ICORR(IZOT2+J)	'IF Z62 IS UNECityLocationPLORED
2750	CONTINUE
2760	IF (IZOT.NE.IZOT2) GOTO 2900
2800	CONTINUE
C 
2900	DESTIN=ILA
	IF (IFO.EQ.6) DESTIN=UnitLocation(2800+ILA)
	ID=IZOT
	DO 3000 I=0,7
	IZOT=ICORR(ID+I)
	NEWLOC=Z6+MoveOffset(IZOT+1)		'**
	IF (IFO.GT.3) THEN
	  IF (IDIST(Z6,DESTIN).LE.IDIST(NEWLOC,DESTIN)) GOTO 3000
	ENDIF
	AC=ReferenceMap(NEWLOC)
	IF ((	(AC.EQ.".").OR.(AC.EQ."+").OR.
	1	(AC.EQ."A").OR.(AC.EQ."T").OR.
	1	(AC.EQ."C").OR.(AC.EQ."S").OR.
	1	(AC.EQ."F").OR.
	1	(AC.EQ."X").OR.(AC.EQ."c") ).AND.(ORDER(NEWLOC).EQ.0))
	1	GOTO 3100
3000	CONTINUE
	IZOT=0
3100	UnitAction(IFI2-1500+Y)=IFO
	UnitActionTarget(IFI2-1500+Y)=ILA
	IF (IFO.LT.4) UnitActionTarget(IFI2-1500+Y)=IZOT
	IF (DebugLevel.EQ.2) TYPE 998,IFO,UnitActionTarget(IFI2-1500+Y)
998	FORMAT(I)
	IF (MOOV.NE.0) IZOT=MOOV
	Z6=Z6+MoveOffset(IZOT+1)			'**
C 
C MOVE EVALUATION
C
	IF (AB.EQ."f") ReferenceMap(Z7)=MasterMap(Z7)
	AB=ReferenceMap(Z6)
	IF ((AB.EQ.".").OR.(AB.EQ."+")) GOTO 3200
	IF ((AB.EQ."X").OR.(AB.EQ."c")) GOTO 3300
	IF (MasterMap(Z6).EQ."*") GOTO 3400
	H2=30
	P=1
	H1=1
	OWN1="f"
	OWN2=AB
	CALL FIND(OWN2,Z6,Z8,H2)
	CALL FGHT(Z6,H1,H2,OWN1,OWN2)
	CALL FIND(OWN2,Z6,Z8,H2)
	IF (H1.LE.0) GOTO 3400
3200	ReferenceMap(Z6)="f"
	STOPF=0
3300	RANG(Y)=RANG(Y)-1
	IF (I1.EQ.1) EnemyCount(2)=EnemyCount(2)+1
	UnitLocation(2000+Y)=Z6
	CALL SONAR(Z6)
	IF (P.EQ.1) CALL SENSOR(Z6)
	IF (STOPF.EQ.1) GOTO 3600
3500	CONTINUE
	GOTO 3600
3400	UnitLocation(2000+Y)=0
	CALL SONAR(Z6)
	IF (P.EQ.1) CALL SENSOR(Z6)
3600	CONTINUE
	RETURN
	END