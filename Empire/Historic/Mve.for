	SUBROUTINE MVE(OWN1,CityLocationCityLocationCityLocationMDATE,RELNUM,NUM,N2,Z6,Z7,DISAS,JURSOR)
C
C	INPUTS:
C		OWN1 = CHAR OF PIECE (IE: "A" FOR ARMY)
C		CityLocationCityLocationCityLocationMDATE = ROUND NUMBER
C		RELNUM = RELATIVE PIECE NUMBER TO TYPE
C		NUM = PIECE INDEX TO UnitLocation
C		N2 = PIECE INDEX TO HITS
C		Z6 = LOCATION, RETURN NEW LOCATION
C		Z7 = OLD LOCATION
C		DISAS = 0:OK, -2:STASIS
C		JURSOR = CURRENT CURSOR
C
	INCLUDE "EMPIRE.INC/NOLIST"
C
C HANDLE PLAYER MOVE MODE
C
	DISAS=0
C GET COMMAND CHARACTER WITH NO ECHO
100	CALL SECTOR(PlayerMap(1))
	IB=UnitHits(N2)
	CALL HEAD(OWN1,RELNUM,NUM,Z6,IB)		'DISPLAY HEADER
	IF (GIGI) CALL REGIS_ON
	CALL CURSOR(JURSOR)
	IF (GIGI) CALL CENTER_CURSOR
	E=GETCHX()
	IF (GIGI) CALL REGIS_OFF
	CALL LIB$ERASE_LINE(2,1)
	CALL LIB$ERASE_LINE(3,1)
C 
C LOOK AT THE COMMAND
C
	Z7=Z6
	DO 300 I=1,9
	IND=I
300	IF (E.EQ.KBTBL(IND)) GOTO 400
	GOTO 500			'COMMAND IS NOT A DIRECTION
400	Z6=Z6+KBFUDG(IND)
	GOTO 4200
C 
500	END=15
	IF (PASS) END=20
	DO 600 I=1,END
600	IF (E.EQ.COMMAN(I)) GOTO 700
	I=0
C	       S,R,I,K,O,L,F,G,P, H, Y, T, V, J, ?,  0,  0, U, N, +
700	GOTO (900,1000,1100,1500,1900,2000,2300,2400,2500,2600,
	1 2700,2800,2900,3200,3300,800,800,3800,3900,2600) I
800	GOTO 100
C 
C S: PUT TO SLEEP
C
900	IF (ReferenceMap(Z6).EQ."O") RETURN
	MYCODE(NUM)=50
	RETURN
C 
C R: RANDOM MOVEMENT
C
1000	IF (OWN1.NE."A") GOTO 100		'ONLY FOR ARMIES
	MYCODE(NUM)=100
	Z6=Z6+MoveOffset(JIGGLE(Z6,NUM)+1)		'**
	RETURN
C 
C I: PUT IN DIRECTIONAL STASIS
C
1100	IF (GIGI) CALL REGIS_ON
	CALL CURSOR(JURSOR)		'CUZ OF CLEAR LINES ABOVE
	IF (GIGI) CALL CENTER_CURSOR
	E=GETCHX()
	IF (GIGI) CALL REGIS_OFF
	DO 1200 I=1,9
	IF (E .EQ. KBTBL(I)) GOTO 1300
1200	CONTINUE
	GOTO 1400
1300	MYCODE(NUM)=CMYTBL(I)
1400	IF (MYCODE(NUM).EQ.0) GOTO 100
	DISAS=-2
	RETURN
C 
C K: KILL STASIS NUMBER ON PIECE
C
1500	MYCODE(NUM)=0			'ZERO FUNCTION CODE FOR ANYTHING

	IF (OWN1.NE."T") GOTO 1700	'IF TRANSPORT, WAKE ARMIES ABOARD
	DO 1600 J=1,500
1600	IF (UnitLocation(J).EQ.Z6) MYCODE(J)=0
	GOTO 100
1700	IF (OWN1.NE."C") GOTO 100	'IF CARRIER, WAKE FIGHTERS ABOARD
	DO 1800 J=501,700
1800	IF (UnitLocation(J).EQ.Z6) MYCODE(J)=0
	GOTO 100
C 
C O: CANCEL AUTO MOVE MODE
C
1900	AUTOMV=.FALSE.
	CALL LIB$SET_CURSOR(3,1)
	CALL STROUT(" Auto move mode canceled.",3)
	GOTO 100
C 
C L: SET UP CITY STASIS NUMBERS
C
2000	IF (MasterMap(Z6).NE."*") GOTO 2300		'BETTER BE A CITY
	E=GETCHX()
	DO 2100 I=1,9
	IF (E .EQ. KBTBL(I)) GOTO 2200
2100	CONTINUE
	GOTO 4100
2200	FIPATH(CITFND(Z6))=CMYTBL(I)		'SET STASIS NUMBER
	DISAS=-2
	RETURN
C 
C F:
C
2300	CALL DIREC
	GOTO 4100
C 
C G: PUT T/C TO SLEEP
C
2400	IF ((OWN1.NE."T").AND.(OWN1.NE."C")) GOTO 100
	MYCODE(NUM)=9997
	DISAS=-2
	RETURN
C 
C P: SECTOR PRINTOUT
C
2500	ISEC=-1
	CALL SECTOR(PlayerMap(1))
	GOTO 4100
C 
C H: GET HELP
C
2600	CALL HELP
	E=GETCHX()
	ISEC=-1
	GOTO 4100
C 
C Y: CHANGE CityProduction OF A CITY
C
2700	CALL DIREC
	GOTO 4100
C 
C T: BLOCK PRINTOUT
C
C2800	CALL CLEAR
C	CALL BLOCK(PlayerMap(1))
C	ISEC=-1
C	GOTO 4100
C 
C V: SAVE GAME
C
C2900	CALL GAME(1,NUM)	'NOT SURE THIS WILL WORK AS PLAYERS ECityLocationPECT
2800	CONTINUE
2900	CALL DIREC
	GOTO 100
C 
C J: PUT IN EDIT MODE
C
3200	CALL EDIT(Z6)
	IF (MYCODE(NUM).EQ.0) GOTO 100
	DISAS=-2
	RETURN
C 
C ?: HOW MANY HITS? LOADED?
C
3300	IF ((OWN1.EQ."A").OR.(OWN1.EQ."F")) GOTO 100
	IB=UnitHits(N2)				'DISPLAY HITS LEFT
	IF (MODE.EQ.1) CALL LIB$SET_CURSOR(2,1)
C	CALL STROUT(" Hits left:",10)
C	CALL DECPRT(IB)
	CALL LIB$ERASE_LINE
	N=0					'COUNT ARMIES
	IF (OWN1.NE."T") GOTO 3500
	DO 3400 I=1,500
3400	IF (UnitLocation(I).EQ.Z6) N=N+1
	IF (N.EQ.0) GOTO 3700
	IF (MODE.EQ.1) CALL LIB$SET_CURSOR(3,1)
	CALL DECPRT(N)
	CALL STROUT(" armies aboard.",1)
	GOTO 4100

3500	IF (OWN1.NE."C") GOTO 4100
	DO 3600 I=1,200				'COUNT FIGHTERS
3600	IF (UnitLocation(I+500).EQ.Z6) N=N+1
	IF (N.EQ.0) GOTO 3700
	IF (MODE.EQ.1) CALL LIB$SET_CURSOR(3,1)
	CALL DECPRT(N)
	CALL STROUT(" fighters aboard.",1)
	GOTO 4100

3700	IF (MODE.EQ.1) CALL LIB$SET_CURSOR(3,1)		'NOTHING ABOARD
	CALL STROUT("Nothing aboard.",1)
	GOTO 4100
C 
C U: CALL REFERENCE MAP
C
3800	ISEC=-1
	CALL SECTOR(ReferenceMap(1))
	GOTO 4100
C 
C N: CALL ENEMY MAP
C
3900	ISEC=-1
	CALL SECTOR(EMAP(1))
	GOTO 4100
C 
C +: BLOCK PRINT REF. MAP
C
4000	CALL LIB$GERASE_PAGE(1,1)
	ISEC=-1
	CALL BLOCK(ReferenceMap(1))
	E=GETCHX()
	GOTO 4100
C 
4100	CALL LTR(Z6,2)
	GOTO 100
4200	IF (ORDER(Z6).EQ.0) GOTO 4300
	IF (MODE.EQ.1) CALL LIB$SET_CURSOR(3,1)
	CALL STROUT("You cannot move onto the edge of the world.",1)
	Z6=Z7
	GOTO 4100
4300	RETURN
	END